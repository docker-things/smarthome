---

${Properties.door}.contact:
  Door is closed - send message:
    if: this is true
    run:
      - SystemWarn.send('${Properties.door} was closed!')
      - SystemNotify.send('${Properties.door} was closed!')
    set:
      House.shouldCheckPresence: 'true'

  Door is opened - someone arrived:
    if:
      - this is false
      - House.presence is false
    run:
      - ${Properties.entrance-room}.lightOn()
      - SystemWarn.send('Someone entered the house')
      - SystemNotify.send('Someone entered the house')

  Door is opened - send message:
    if: this is false
    run:
      - SystemWarn.send('${Properties.door} was opened!')
      - SystemNotify.send('${Properties.door} was opened!')
    set:
      House.presence: 'true'

House.openWindows:
  When opening windows without presence:
    if:
      - this is true
      - House.presence is false
    run:
      - SystemWarn.send('Someone opened windows but house is empty!')
      - SystemNotify.send('Someone opened windows but house is empty!')

House.presence:
  When house is empty:
    if:
      - this is false
    run:
      - House.offWithoutVacuum()
      - SystemWarn.send('House is empty. Turned everything off.')
      - SystemNotify.send('House is empty. Turned everything off.')

  When house is empty with opened windows:
    if:
      - this is false
      - House.openWindows is true
    run:
      - SystemWarn.send('Windows are opened!')
      - SystemNotify.send('Windows are opened!')

  When house is populated:
    if:
      - this is true
    run:
      - SystemWarn.send('Presence detected!')
      - SystemNotify.send('Presence detected!')
